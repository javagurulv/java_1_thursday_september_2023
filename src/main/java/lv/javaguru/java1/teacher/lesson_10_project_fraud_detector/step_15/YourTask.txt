Пример реализации предложенных изменений можно найти в коде.

Сравните его с тем, что получилось у вас.

Можно ли переписать это решение с использованием Stream API?